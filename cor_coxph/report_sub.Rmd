# Day `r COR` Univariate CoR: Cox Models of Risk {#cor-coxph-Day`r COR`}

The main regression model is the Cox proportional hazards model. All plots are made with Cox models fit unless specified otherwise.

## Hazard ratios

\begin{table}[H]
\caption{Inference for Day `r tpeak` antibody marker covariate-adjusted correlates of risk of COVID in the vaccine group: Hazard ratios per 10-fold increment in the marker*}
\begin{center}
    \input{`r pathCoRoutput`/CoR_univariable_svycoxph_pretty_`r study_name`}\\
\end{center}
*Baseline covariates adjusted for: baseline risk score, `r ifelse(study_name_code=="COVE", "meeting the protocol randomization stratification criterion for being at heightened risk of COVID (yes or no), community of color or not", "region (US, South Africa, or Latin American)")`. Maximum failure event time \input{`r pathCoRoutput`/timepoints_cum_risk_`r study_name`} days.\\
**No. at-risk = estimated number in the population for analysis: baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint `r if(!endsWith(COR,"start1")) "through 6 days post" else "through"` Day `r tpeak` visit; no. cases = number of this cohort with an observed COVID endpoint.\\
***q-value and FWER (family-wide error rate) are computed over the set of p-values both for quantitative markers and categorical markers `r ifelse(study_name_code=="COVE", "", "")` using the Westfall and Young permutation method (\protect\input{`r pathCoRoutput`/permutation_replicates_`r study_name`} replicates). \\
`r special.note`
    %\label{tab:CoR_univariable_svycoxph_pretty_`r study_name`}
\end{table}


\begin{table}[H]
\caption{Inference for Day `r tpeak` antibody marker covariate-adjusted correlates of risk of COVID in the vaccine group: Hazard ratios for Middle vs. Upper tertile vs. Lower tertile*}
\begin{center}
\setlength{\tabcolsep}{.5ex}
\input{`r pathCoRoutput`/CoR_univariable_svycoxph_cat_pretty_`r study_name`}\\
\end{center}
*Baseline covariates adjusted for: baseline risk score, meeting the protocol randomization stratification criterion for being at heightened risk of COVID (yes or no), `r ifelse(study_name_code=="COVE", "community of color or not", "strata(Region)")`. 
Maximum failure event time \protect\input{`r pathCoRoutput`/timepoints_cum_risk_`r study_name`} days.
Cutpoints:
%Day `r tpeak` cutpoints:
\input{`r pathCoRoutput`/cutpoints_Day`r tpeak`bindSpike_`r study_name`},  
\input{`r pathCoRoutput`/cutpoints_Day`r tpeak`bindRBD_`r study_name`},  
`r if(study_name_code!="ENSEMBLE") paste0("\\input{", pathCoRoutput, "/cutpoints_Day", tpeak, "pseudoneutid50_", study_name, "},")`
`r if(study_name_code!="ENSEMBLE") paste0("\\input{", pathCoRoutput, "/cutpoints_Day", tpeak, "pseudoneutid80_", study_name, "},")`
all on the log10 scale.
%fold-rise cutpoints:
%\input{`r pathCoRoutput`/cutpoints_Delta`r tpeak`overBbindSpike_`r study_name`},  
%\input{`r pathCoRoutput`/cutpoints_Delta`r tpeak`overBbindRBD_`r study_name`},  
%\input{`r pathCoRoutput`/cutpoints_Delta`r tpeak`overBpseudoneutid50_`r study_name`},  
%\input{`r pathCoRoutput`/cutpoints_Delta`r tpeak`overBpseudoneutid80_`r study_name`}.  
\\
**No. at-risk = estimated number in the population for analysis: baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint `r if(!endsWith(COR,"start1")) "through 6 days post" else "through"` Day `r tpeak` visit; no. cases = number of this cohort with an observed COVID endpoint.\\
***Generalized Wald-test p-value of the null hypothesis that the hazard rate is constant across the Lower, Middle, and Upper tertile groups.\\
$\dagger$ q-value and FWER (family-wide error rate) are computed over the set of p-values both for quantitative markers and categorical markers `r ifelse(study_name_code=="COVE", "", "")` using the Westfall and Young permutation method (\protect\input{`r pathCoRoutput`/permutation_replicates_`r study_name`} replicates). \\
`r special.note`

    %\label{tab:CoR_univariable_svycoxph_cat_pretty_`r study_name`}
\end{table}

\clearpage

`r if(study_name_code!="ENSEMBLE") paste0("
\\begin{figure}[H]
    \\includegraphics[width=1\\textwidth]{", pathCoRoutput, "/hr_forest_bindSpike_", study_name, "}
    \\includegraphics[width=1\\textwidth]{", pathCoRoutput, "/hr_forest_bindRBD_",   study_name, "}
    \\includegraphics[width=1\\textwidth]{", pathCoRoutput, "/hr_forest_pseudoneutid50_",  study_name, "}
    \\includegraphics[width=1\\textwidth]{", pathCoRoutput, "/hr_forest_pseudoneutid80_",  study_name, "}
    \\caption{Forest plots of hazard ratios per 10-fold increase in the marker among baseline negative vaccine recipients and subgroups with 95\\% point-wise confidence intervals.", special.note, "}
\\end{figure}
\\clearpage
")`

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/hr_forest_marginal_bindSpike_`r study_name`}
    \caption{Forest plots of hazard ratios per 10-fold increase in the Day `r tpeak` binding Ab to spike markers among baseline negative vaccine recipients (top row) and different subpopulations with 95\% point-wise confidence intervals. `r special.note`}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/hr_forest_marginal_bindRBD_`r study_name`}
    \caption{Forest plots of hazard ratios per 10-fold increase in the  Day `r tpeak` binding Ab to RBD markers among baseline negative vaccine recipients (top row) and different subpopulations with 95\% point-wise confidence intervals. `r special.note`}
\end{figure}

\ifENSEMBLE
\else

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/hr_forest_marginal_pseudoneutid50_`r study_name`}
    \caption{Forest plots of hazard ratios per 10-fold increase in the  Day `r tpeak` pseudo neut ID50 markers among baseline negative vaccine recipients (top row) and different subpopulations with 95\% point-wise confidence intervals. `r special.note`}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/hr_forest_marginal_pseudoneutid80_`r study_name`}
    \caption{Forest plots of hazard ratios per 10-fold increase in the  Day `r tpeak` pseudo neut ID80 markers among baseline negative vaccine recipients (top row) and different subpopulations with 95\% point-wise confidence intervals. `r special.note`}
\end{figure}

\fi



\clearpage


\newif\ifShowCountry
`r if (study_name_code=="ENSEMBLE" & (config$subset_variable=="None" | config$subset_value==1)) "\\ShowCountrytrue"` 

\ifShowCountry

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/hr_forest_countries_bindSpike_`r study_name`}
    \caption{Forest plots of hazard ratios per 10-fold increase in the Day `r tpeak` binding Ab to spike markers among baseline negative vaccine recipients (top row) and different subpopulations with 95\% point-wise confidence intervals. `r special.note`}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/hr_forest_countries_bindRBD_`r study_name`}
    \caption{Forest plots of hazard ratios per 10-fold increase in the  Day `r tpeak` binding Ab to RBD markers among baseline negative vaccine recipients (top row) and different subpopulations with 95\% point-wise confidence intervals. `r special.note`}
\end{figure}

\fi



<!-- \begin{table}[H] -->
<!--     \setlength{\tabcolsep}{.5ex} -->
<!-- \scriptsize{ -->
<!--     \input{`r pathCoRoutput`/CoR_univariable_svycoxph_`r study_name`} -->
<!-- } -->
<!-- \caption{CoR models among baseline negative vaccine recipients. Each column corresponds to one Cox model fitted by survey::svycoxph.} -->
<!--     \label{tab:CoR_univariable_svycoxph_`r study_name`} -->
<!-- \end{table} -->
<!-- \begin{table}[H] -->
<!--     \setlength{\tabcolsep}{.5ex} -->
<!--     \input{`r pathCoRoutput`/CoR_pseudoneutid80_sens_noCases_`r study_name`} -->
<!-- \caption{CoR models for Day `r tpeak` pseudo neut ID80 among baseline negative vaccine recipients. Each row corresponds to one Cox model fitted by survey::svycoxph.For each model, a different dataset that keeps a random subset of the cases is used. The original dataset has 66 cases.} -->
<!--     \label{tab:CoR_Day`r tpeak`pseudoneutid80_sens_noCases_`r study_name`} -->
<!-- \end{table} -->
<!-- \begin{table}[H] -->
<!--     \setlength{\tabcolsep}{.5ex} -->
<!--     \input{`r pathCoRoutput`/CoR_pseudoneutid80_5cases_`r study_name`} -->
<!-- \caption{CoR models for Day `r tpeak` pseudo neut ID80 among baseline negative vaccine recipients. Each row corresponds to one Cox model fitted by survey::svycoxph.For each model, a different dataset that keeps a random subset of 5 cases is used.} -->
<!--     \label{tab:CoR_Day`r tpeak`pseudoneutid80_5cases_`r study_name`} -->
<!-- \end{table} -->
<!-- \begin{table}[H] -->
<!--     \input{`r pathCoRoutput`/CoR_univariable_tps} -->
<!--     \caption{CoR models among baseline negative vaccine recipients. Each column corresponds to one logistic regression model fitted by osDesign::tps. } -->
<!--     \label{tab:CoR_univariable_tps} -->
<!-- \end{table} -->
<!-- \begin{table}[H] -->
<!--     \input{`r pathCoRoutput`/CoR_univariable_hingelogistic} -->
<!--     \caption{CoR models among baseline negative vaccine recipients. Each column corresponds to one logistic regression model with hinge fitted by chgnpt::chngptm. } -->
<!--     \label{tab:CoR_univariable_hingelogistic} -->
<!-- \end{table} -->





## Marginalized risk and controlled vaccine efficacy plots


\begin{table}[H] 
\caption{Analysis of Day `r tpeak` markers (upper vs. lower tertile) as a CoR and a controlled risk CoP.}
\begin{center}
\begin{tabular}{lcccccc} \hline 
 & \multicolumn{2}{c}{marginalized risk} & \multicolumn{2}{c}{controlled risk} & & \\ 
 & \multicolumn{2}{c}{ratio $RR_M(0,1)$} & \multicolumn{2}{c}{ratio $RR_C(0,1)^1$} & \multicolumn{2}{c}{e(0,1)$^2$} \\ 
  & Point Est. & 95\% CI  &    Point Est. & 95\% CI  &   Point Est.  & 95\% CI UL \\ \hline
\input{`r pathCoRoutput`/marginalized_risks_cat_`r study_name`}  \\ \hline 
\end{tabular}
\end{center}
$^1$Conservative (upper bound) estimate assuming unmeasured confounding at level $RR_{UD}(0,1)=RR_{EU}(0,1) = 2$ and thus $B(0,1)=4/3$. \\
$^2$E-values are computed for upper tertile ($s=1$) vs. lower tertile ($s=0$) biomarker subgroups after controlling for baseline risk score, meeting the protocol randomization stratification criterion for being at heightened risk of COVID (yes or no), `r ifelse(study_name_code=="COVE", "community of color or not", "strata(Region)")`; UL = upper limit.\\
`r special.note`
\end{table}




\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/marginalized_risks_cat_`r study_name`}
    \caption{Marginalized cumulative incidence rate curves for trichotomized Day `r tpeak` markers among baseline negative vaccine recipients. The gray line is the overall cumulative incidence rate curve in the placebo arm. `r special.note`}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/marginalized_risks_eq_`r study_name`}
    \caption{Marginalized cumulative risk by Day \protect\input{`r pathCoRoutput`/timepoints_cum_risk_`r study_name`} as functions of Day `r tpeak` markers (=s) among baseline negative vaccine recipients with 95\% bootstrap point-wise confidence bands (\protect\input{`r pathCoRoutput`/bootstrap_replicates_`r study_name`} replicates). The horizontal lines indicate the overall cumulative risk of the placebo and vaccine arms by Day \protect\input{`r pathCoRoutput`/timepoints_cum_risk_`r study_name`} and its 95\% point-wise confidence interval. Histograms of the immunological markers in the vaccine arm are overlaid. lod =`r if ("bindSpike" %in% assays) paste0(" ", round(llods["bindSpike"],1), " for bAb Spike,")``r if ("bindRBD" %in% assays) paste0(" ", round(llods["bindRBD"],1), " for bAb RBD,")``r if ("pseudoneutid50" %in% assays) paste0(" ", round(llods["pseudoneutid50"],1), " for PsV nAb ID50,")``r if ("pseudoneutid80" %in% assays) paste0(" ", round(llods["pseudoneutid80"],1), " for PsV nAb ID80,")` respectively. `r special.note`}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/controlled_ve_curves_eq_manus_`r study_name`}
    \caption{Controlled VE with sensitivity analysis as functions of Day `r tpeak` markers (=s) among baseline negative vaccine recipients with 95\% bootstrap point-wise confidence bands (\protect\input{`r pathCoRoutput`/bootstrap_replicates_`r study_name`} replicates). Histograms of the immunological markers in the vaccine arm are overlaid. lod =`r if ("bindSpike" %in% assays) paste0(" ", round(llods["bindSpike"],1), " for bAb Spike,")``r if ("bindRBD" %in% assays) paste0(" ", round(llods["bindRBD"],1), " for bAb RBD,")``r if ("pseudoneutid50" %in% assays) paste0(" ", round(llods["pseudoneutid50"],1), " for PsV nAb ID50,")``r if ("pseudoneutid80" %in% assays) paste0(" ", round(llods["pseudoneutid80"],1), " for PsV nAb ID80,")` respectively. `r special.note`}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/controlled_ve_curves_eq_`r study_name`}
    \caption{Controlled VE with sensitivity analysis as functions of Day `r tpeak` markers (=s) among baseline negative vaccine recipients with 95\% bootstrap point-wise confidence bands (\protect\input{`r pathCoRoutput`/bootstrap_replicates_`r study_name`} replicates). Histograms of the immunological markers in the vaccine arm are overlaid. lod =`r if ("bindSpike" %in% assays) paste0(" ", round(llods["bindSpike"],1), " for bAb Spike,")``r if ("bindRBD" %in% assays) paste0(" ", round(llods["bindRBD"],1), " for bAb RBD,")``r if ("pseudoneutid50" %in% assays) paste0(" ", round(llods["pseudoneutid50"],1), " for PsV nAb ID50,")``r if ("pseudoneutid80" %in% assays) paste0(" ", round(llods["pseudoneutid80"],1), " for PsV nAb ID80,")` respectively. `r special.note`}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/marginalized_risks_geq_woplacebo_`r study_name`}
    \caption{Marginalized cumulative risk by Day \protect\input{`r pathCoRoutput`/timepoints_cum_risk_`r study_name`} post Day `r tpeak` visit as functions of Day `r tpeak` markers above a threshold ($\geq s$) among baseline negative vaccine recipients with 95\% bootstrap point-wise confidence bands (at least 5 cases are required, \protect\input{`r pathCoRoutput`/bootstrap_replicates_`r study_name`} replicates). The horizontal lines indicate the overall cumulative risk of the vaccine arm by Day \protect\input{`r pathCoRoutput`/timepoints_cum_risk_`r study_name`} and its 95\% point-wise confidence interval. Histograms of the immunological markers in the vaccine arm are overlaid. lod =`r if ("bindSpike" %in% assays) paste0(" ", round(llods["bindSpike"],1), " for bAb Spike,")``r if ("bindRBD" %in% assays) paste0(" ", round(llods["bindRBD"],1), " for bAb RBD,")``r if ("pseudoneutid50" %in% assays) paste0(" ", round(llods["pseudoneutid50"],1), " for PsV nAb ID50,")``r if ("pseudoneutid80" %in% assays) paste0(" ", round(llods["pseudoneutid80"],1), " for PsV nAb ID80,")` respectively. `r special.note`}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/controlled_ve_curves_geq_`r study_name`}
    \caption{Controlled VE as functions of Day `r tpeak` markers (>=s) among baseline negative vaccine recipients with 95\% bootstrap point-wise confidence bands (\protect\input{`r pathCoRoutput`/bootstrap_replicates_`r study_name`} replicates). Histograms of the immunological markers in the vaccine arm are overlaid. lod =`r if ("bindSpike" %in% assays) paste0(" ", round(llods["bindSpike"],1), " for bAb Spike,")``r if ("bindRBD" %in% assays) paste0(" ", round(llods["bindRBD"],1), " for bAb RBD,")``r if ("pseudoneutid50" %in% assays) paste0(" ", round(llods["pseudoneutid50"],1), " for PsV nAb ID50,")``r if ("pseudoneutid80" %in% assays) paste0(" ", round(llods["pseudoneutid80"],1), " for PsV nAb ID80,")` respectively. `r special.note`}
\end{figure}






\clearpage
\setlength{\tabcolsep}{.5ex}
\input{`r pathCoRoutput`/marginalized_risks_eq_`r study_name`}

\clearpage
\setlength{\tabcolsep}{.5ex}
\input{`r pathCoRoutput`/controlled_ve_eq_`r study_name`}

\clearpage
\setlength{\tabcolsep}{.5ex}
\input{`r pathCoRoutput`/controlled_ve_sens_eq_`r study_name`}



\clearpage

## Misc

Average follow-up of vaccine recipients (in the `r COR` correlates analyses population) starting at 7 days post Day `r tpeak` visit (not counting the 7 days) is \input{`r pathCoRoutput`/avg_followup_`r study_name`} days.
 

`r if(tpeak=="57") paste0("Number of breakthrough vaccine cases (in the Day 57 correlates analyses population) with Day 57 ID80 > 660 IU: \\input{", pathCoRoutput, "/num_vacc_cases_highid80_", study_name, "}.")`


\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{`r pathCoRoutput`/barplot_visit_intervals_immuno}
    \caption{Distribution of the number of days between visits in the per-protocol immunogenicity subcohort, vaccine arm, baseline negative. `r paste0("The median (IQR) number of days between Day 1 and Day 29 was \\protect\\input{", pathCoRoutput, "/quartiles_visit_intervals_immuno_1to29}.")` `r if(tpeak=="57") paste0("The median (IQR) number of days between Day 29 and Day 57 was \\protect\\input{", pathCoRoutput, "/quartiles_visit_intervals_immuno_29to57}.")`  `r special.note`}
\end{figure}


`r if(tpeak=="57") paste0("
\\begin{figure}[H]
    \\centering
    \\includegraphics[width=1\\textwidth]{", pathCoRoutput, "/barplot_mixed}
    \\caption{Distribution of the number of days to COVID endpoints, vaccine arm, baseline negative. ", special.note, "}
\\end{figure}
")`


\ifENSEMBLE
\else

\begin{table}[H]
\caption{Deciles of Day `r tpeak` cID50 titer for the immunogenicity subcohort in the vaccine arm.}
\begin{center}
\setlength{\tabcolsep}{.5ex}
\input{`r pathCoRoutput`/cID50_deciles_`r study_name`}
\end{center}
\end{table}


\begin{table}[H]
\caption{Summary statistics for the number of days from dose 1 to Day `r tpeak` visit. (a) The whole immunogenicity subcohort, (b) non-cases in the immunogenicity subcohort, (c) intercurrent cases, (d) primary cases, i.e. cases from the Day 57 correlates analysis population.  `r special.note`}
\begin{center}
\setlength{\tabcolsep}{.5ex}
\input{`r pathCoRoutput`/dose1_interval_summary_`r study_name`}
\end{center}
\end{table}

\fi