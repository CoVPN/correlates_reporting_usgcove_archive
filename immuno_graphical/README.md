#  Graphical Descriptions of COVID-19 Vaccine Immunogenicity

This folder contains R programs that produce figures showing COVID-19 vaccine
immunogenicity for vaccine efficacy trials.

## Subdirectories:

* `code`: scripts for cleaning data and producing figures
  1. `covid_corr_plot_functions.R`: This file contains R functions that
        generates `ggplot2` style pair plots, boxplots, weighted RCDF plots and
        scatter plots;
  2. `ggally_cor_resample.R`: In the scatter plots we added resampling-based
         baseline strata adjusted Spearman correlation of the plotted variables
        in each panel. This R script contains a function that implement this
        calculation.
  3. `params.R`: This R script defines the common variables used across the
         immunogenicity graphical analysis.
  4. `descriptive_graphics_data_preprocess.R`: Given a new dataset, this R
         script performs data cleaning to produce datasets that are convenient
        for downstream plotting.
  5. `descriptive_graphics_two_phase_plots.R`: This R script produces plots that
        indicate the immunogenicity of the vaccine using the tidy datasets
        generated by `descriptive_graphics_data_preprocess.R`. Subjects are
        grouped by the treatment group and baseline serovirus status.
  6. `descriptive_graphics_demographic_strata.R`: This R script produces
        immunogenicity plots where subjects are grouped by baseline demographic
        variables.
* `data_clean`: post-processed data used as input to statistical analyses
* `figs`: folders where immunogenicity plots are saved.
   - The subgroup plots produced by `descriptive_graphics_demographic_strata.R`
      are saved in "demographics" subfolder.

## Implementation

To implement the functions in this folder and produce immunogenicity plots,
follow the steps below:
1. In `code/params.R`, change the variable "assay" to specify the types of
    biomarker assay for plotting; change the variable "times" to specify the
    time points for the comparative analysis; change the labels correspondingly.
2. In `code/descriptive_graphics_data_preprocess.R`, change the variable `dat`
     to specify the data input.
3. The R scripts `code/descriptive_graphics_two_phase_plots.R` and
    `code/descriptive_graphics_demographic_strata.R` contain the R code that
    produces a default set of immunogenicity plots; feel free to customize the
    plots by changing the file name, changing the plot style, adding more
    aesthetics, etc.
4. Via the command line to implement to work flow: change the working directory
    to `immuno_graphical` and simply type `make`.
The plots will be saved in `figs/` and `figs/demographics/`. Check if the plots
match your expectation.
